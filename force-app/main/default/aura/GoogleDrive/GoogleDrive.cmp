<aura:component controller="CommunityAssignmentClassGoogleDrive" implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickAction" access="global">
<!-- Attributes -->
<aura:attribute name="filetype" type="List" default="['.png', '.jpg', '.jpeg','.pdf']" />
<aura:attribute name="multiple" type="Boolean" default="true" />
<aura:attribute name="disabled" type="Boolean" default="true" />
<aura:attribute name="recordId" type="String" />
<aura:attribute name="files" type="List" />
<aura:attribute name="fileId" type="String" />
<aura:attribute name="breadCrumbFileId" type="String" default="root" /><!--attribute for storing currently in which folder component is present-->


<aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    <aura:attribute name="accessToken" type="String" />
    <aura:attribute name="access" type="String" />
    <aura:attribute name="breadcrumbCollection" type="Object"/>
    <aura:attribute name="loaded" type="Boolean" default="false" />

    <div class="exampleHolder">
        <aura:if isTrue="{! v.loaded }">
            <aura:set attribute="else">
                <lightning:spinner alternativeText="Loading" />
            </aura:set>
        </aura:if>
    </div>

    <lightning:breadcrumbs>
        <aura:iteration items="{! v.breadcrumbCollection }" var="breadcrumb">
            
            <lightning:breadcrumb label="{! breadcrumb.label }" onclick="{! c.navigateTo }" id="{! breadcrumb.id }"/>
        </aura:iteration>
    </lightning:breadcrumbs>
    <div class="slds-scrollable_y" style="margin-top: 2rem;height: 450px;">
        <table  style="position:relative;">
            <tr style="font-size: 1rem;  font-weight: bold;">
                <th>Icon</th>
                <th>Name</th>
                <th>Download</th>
                <th>Delete</th>
            </tr>
            <aura:iteration items="{!v.files}" var="file"> 
                <tr style="border-bottom: 1px solid blue">
                    <td>
                        <aura:if isTrue="{!file.mimiType=='application/vnd.google-apps.folder'}" >
                            <lightning:icon iconName="utility:open_folder" alternativeText="Approved" title="Approved" />
                        </aura:if>
                        <aura:if isTrue="{!file.mimiType=='text/csv'}" >
                            <!-- <lightning:icon iconName="doctype:audio" alternativeText="Audio file" title="Audio" /> -->
                            <lightning:icon iconName="doctype:csv" alternativeText="Approved" title="Approved" />
                        </aura:if>
                        <aura:if isTrue="{!file.mimiType=='application/vnd.google-apps.spreadsheet'}" >
                            <lightning:icon iconName="doctype:excel" alternativeText="Approved" title="Approved" />
                        </aura:if>
                        <aura:if isTrue="{!file.mimiType=='image/jpeg'}" >
                            <lightning:icon iconName="utility:image" alternativeText="Approved" title="Approved" />
                        </aura:if>
                        <aura:if isTrue="{!file.mimiType=='video/mp4'}">
                            <lightning:icon iconName="doctype:mp4" alternativeText="Approved" title="Approved" />
                        </aura:if>
                    </td>
                    <aura:if isTrue="{!file.mimiType=='application/vnd.google-apps.folder'}" >
                        <td data-tit = "{!file.Id}" data-name="{!file.name}" onclick="{!c.openFolderFiles}">
                            <a style="cursor: pointer;text-decoration:none;" id="{!file.Id}" >{!file.name}</a>   
                        </td>
                    </aura:if>
                    <aura:if isTrue="{!file.mimiType!='application/vnd.google-apps.folder'}" >
                        <td >
                            <a href="{!file.alternativeLink}" target="_blank" style="cursor: pointer; text-decoration:none;" id="{!file.Id}" >{!file.name}</a>    
                        </td>
                    </aura:if>
                    <aura:if isTrue="{!file.mimiType!='application/vnd.google-apps.folder'}" >
                        <td>
                            <a href="{!file.downLoadLink}">
                                <lightning:icon iconName="action:download" size="small"  alternativeText="Approved" title="Approved" style="cursor: pointer;"   />
                            </a>
                        </td>
                    </aura:if>
                    <aura:if isTrue="{!file.mimiType=='application/vnd.google-apps.folder'}">
                        <td>
                            <lightning:icon iconName="action:download" size="small"  alternativeText="Approved" title="Approved"   style="background-color: gainsboro;" />
                        </td>
                    </aura:if>
                    <td data-tit = "{!file.Id}" onclick="{!c.deleteFile}">      
                        <lightning:icon iconName="action:delete" size="small" alternativeText="Approved" title="Approved" style="cursor: pointer;"/>
                    </td>
                </tr>
            </aura:iteration>
        </table>
    </div>
    <!-- <lightning:input aura:id="fuploader" onchange="{!c.handleFilesChange}" type="file" name="file" label="Upload File" multiple="false"/> -->
    <!-- <lightning:input aura:id="fuploader" onchange="{!c.handleFilesChange}" type="file" name="file" label="Upload File" multiple="false"/> -->
    <div style="display: flex; flex-direction: row; margin-top:4rem;">
        <lightning:button class="slds-m-left_x-small" variant="brand-outline" name="Create" label="create new folder" onclick="{!c.createNewFolder}" ></lightning:button>
        <lightning:fileUpload label="Attach receipt"
        name="fileUploader"
        multiple="false"
        accept="{!v.filetype}"
        recordId="{!v.recordId}"
        onuploadfinished="{!c.handleUploadFinished}" style="margin-left: 1rem "/>
    </div>
</aura:component>